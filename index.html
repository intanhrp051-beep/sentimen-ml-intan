<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<title>Klasifikasi Sentimen (Tanpa Backend)</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
 body {font-family: Poppins, Arial; background:#0a0f24; color:#e3e3e3; padding:30px;}
 .container {max-width:900px; margin:auto; background:rgba(255,255,255,0.05); padding:25px; border-radius:16px;}
 textarea {width:100%; height:130px; padding:15px; background:#11182f; color:#fff; border-radius:10px;}
 button {width:100%; padding:12px; margin-top:15px; border-radius:10px; background:linear-gradient(45deg,#004dff,#0084ff); color:white; cursor:pointer;}
 table {width:100%; margin-top:20px; border-collapse:collapse; background:#11182f;}
 th,td {padding:10px; border:1px solid #2d3d66;}
 th {background:#0f1a3a; color:#7cb8ff;}
 .result-box {margin-top:20px; padding:15px; background:#11182f; border-left:5px solid #4da3ff; border-radius:10px; display:none;}
</style>
</head>
<body>
<div class="container">
 <h2>ðŸ”® Sistem Klasifikasi Sentimen </h2>

 <label><b>Tulis Review Pelanggan:</b></label>
 <textarea id="review" placeholder="Contoh: Produk ini sangat bagus..."></textarea>

 <button id="btn">Klasifikasikan</button>

 <div id="result" class="result-box">
   <b>Sentimen:</b> <span id="sentimen"></span><br>
   <b>Confidence:</b> <span id="confidence"></span>
 </div>

 <h3 style="margin-top:30px;">ðŸ“Œ Riwayat Klasifikasi</h3>
 <table id="historyTable">
  <tr>
   <th>ID</th>
   <th>Review</th>
   <th>Sentimen</th>
   <th>Confidence</th>
   <th>Waktu</th>
  </tr>
 </table>

 <h3 style="margin-top:30px;">ðŸ“Š Statistik Sentimen</h3>
 <canvas id="sentimentChart" height="150"></canvas>
</div>

<script>
// Lexicon sederhana
const positiveWords = ["bagus", "mantap", "hebat", "luar biasa", "keren", "puas", "suka", "recommended", "terbaik"];
const negativeWords = ["buruk", "jelek", "parah", "mengecewakan", "benci", "tidak puas", "sampah", "fatal", "lemah"];

let history = [];

// Fungsi klasifikasi lokal
function classifyText(text) {
    text = text.toLowerCase();
    let score = 0;

    positiveWords.forEach(w => { if (text.includes(w)) score++; });
    negativeWords.forEach(w => { if (text.includes(w)) score--; });

    let sentimen = "Netral";
    if (score > 0) sentimen = "Positif";
    else if (score < 0) sentimen = "Negatif";

    let confidence = Math.min(Math.abs(score) / 3, 1);

    return { sentimen, confidence };
}

// Tombol proses

document.getElementById("btn").onclick = () => {
    let review = document.getElementById("review").value.trim();
    let resultBox = document.getElementById("result");

    if (review.length < 5) return alert("Review minimal 5 karakter.");

    const { sentimen, confidence } = classifyText(review);

    resultBox.style.display = "block";
    document.getElementById("sentimen").innerHTML = sentimen;
    document.getElementById("confidence").innerHTML = (confidence * 100).toFixed(1) + "%";

    // Simpan ke riwayat
    history.push({
        id: history.length + 1,
        review,
        sentimen,
        confidence,
        timestamp: new Date().toLocaleString()
    });

    loadHistory();
    loadChart();
};

function loadHistory() {
    let table = document.getElementById("historyTable");
    table.innerHTML = `
        <tr>
            <th>ID</th>
            <th>Review</th>
            <th>Sentimen</th>
            <th>Confidence</th>
            <th>Waktu</th>
        </tr>`;

    history.forEach(r => {
        table.innerHTML += `
        <tr>
            <td>${r.id}</td>
            <td>${r.review}</td>
            <td>${r.sentimen}</td>
            <td>${(r.confidence * 100).toFixed(1)}%</td>
            <td>${r.timestamp}</td>
        </tr>`;
    });
}

let chart;
function loadChart() {
    let pos = history.filter(h => h.sentimen === "Positif").length;
    let neg = history.filter(h => h.sentimen === "Negatif").length;
    let neu = history.filter(h => h.sentimen === "Netral").length;

    if (chart) chart.destroy();

    chart = new Chart(document.getElementById("sentimentChart"), {
        type: "pie",
        data: {
            labels: ["Positif", "Negatif", "Netral"],
            datasets: [{
                data: [pos, neg, neu],
                backgroundColor: ["#00c853", "#d50000", "#ffeb3b"]
            }]
        }
    });
}
</script>
</body>
</html>